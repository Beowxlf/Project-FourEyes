#Â ğŸ§ Â EventÂ IDÂ 4688Â -Â ProcessÂ Creation

##Â ğŸ“ŒÂ Summary

EventÂ 4688Â logsÂ wheneverÂ aÂ newÂ processÂ isÂ created.Â ThisÂ isÂ crucialÂ forÂ trackingÂ executionÂ ofÂ binariesÂ andÂ understandingÂ processÂ trees.

##Â ğŸ§¾Â LogÂ Details

-Â **LogÂ Name**:Â Security

-Â **Source**:Â MicrosoftÂ WindowsÂ securityÂ auditing

-Â **EventÂ ID**:Â 4688

-Â **Level**:Â Information

##Â ğŸ§©Â KeyÂ Fields

-Â `NewProcessName`:Â FullÂ pathÂ ofÂ theÂ executable

-Â `ProcessId`:Â IDÂ ofÂ theÂ newÂ process

-Â `ParentProcessName`:Â PathÂ ofÂ theÂ parentÂ process

-Â `CreatorProcessId`:Â IDÂ ofÂ theÂ parentÂ process

-Â `CommandLine`:Â FullÂ commandÂ lineÂ usedÂ toÂ launchÂ theÂ process

##Â ğŸ”Â UseÂ Cases

-Â DetectingÂ suspiciousÂ processÂ chainsÂ (e.g.,Â `winword.exe`Â spawningÂ `powershell.exe`)

-Â MonitoringÂ LOLBinsÂ (LivingÂ OffÂ TheÂ LandÂ Binaries)

-Â IdentifyingÂ unusualÂ command-lineÂ arguments

##Â ğŸ›¡ï¸Â SigmaÂ DetectionÂ Example

```yaml

title:Â SuspiciousÂ PowerShellÂ Execution

id:Â 12345678-4688-powershell

status:Â experimental

logsource:

Â Â product:Â windows

Â Â service:Â security

Â Â definition:Â 'EventÂ IDÂ 4688'

detection:

Â Â selection:

Â Â Â Â EventID:Â 4688

Â Â Â Â NewProcessName|endswith:Â '\powershell.exe'

Â Â Â Â CommandLine|contains:

Â Â Â Â Â Â -Â '-enc'

Â Â Â Â Â Â -Â 'Invoke-Expression'

Â Â condition:Â selection

fields:

Â Â -Â CommandLine

Â Â -Â ParentProcessName

Â Â -Â NewProcessName

level:Â high